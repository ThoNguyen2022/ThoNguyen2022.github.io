<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bảng Giá Dịch Vụ In Ấn & Thiết Kế</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
        }

        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 30px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        h1,
        h2 {
            text-align: center;
            color: #333;
        }

        h1 {
            border-bottom: 2px solid #0056b3;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        th,
        td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #0056b3;
            color: white;
            text-transform: uppercase;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .note {
            text-align: center;
            font-style: italic;
            color: #666;
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-control {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #0056b3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        .btn:hover {
            background-color: #004494;
        }

        .result {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-top: 20px;
            border: 1px dashed #0056b3;
            padding: 10px;
            border-radius: 4px;
        }

        /* Container chính dùng cho Grid */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr) 1fr;
            /* 3 cột bằng nhau và 1 cột cho nút */
            gap: 15px;
            margin-bottom: 15px;
            align-items: flex-end;
            /* Căn chỉnh các item theo đáy */
        }

        /* Các trường nhập liệu */
        .grid-item {
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        /* Điều chỉnh nút để chiếm 2 hàng */
        .button-span {
            grid-column: 4;
            grid-row: 1 / span 2;
            /* Bắt đầu từ hàng 1 và kéo dài 2 hàng */
            height: 100%;
            display: flex;
            align-items: center;
            /* Căn giữa nút theo chiều dọc */
        }

        /* Đảm bảo nút chiếm 100% chiều cao của cột chứa nó */
        .button-span .btn {
            height: 100%;
            width: 100%;
            margin: 0;
        }
    </style>
</head>

<body>
    <div id="photo-printing">
        <h2>In Ảnh Theo Yêu Cầu</h2>
        <div class="grid-container">
            <div class="grid-item">
                <label for="quantity">Số lượng:</label>
                <input type="number" id="quantity" class="form-control" min="1" value="10">
            </div>
            <div class="grid-item">
                <label for="length">Chiều dài (mm):</label>
                <input type="number" id="length" class="form-control" min="1" max="280" value="54">
            </div>
            <div class="grid-item">
                <label for="width">Chiều rộng (mm):</label>
                <input type="number" id="width" class="form-control" min="1" max="200" value="90">
            </div>
            <div class="grid-item">
                <label for="double-sided">Số mặt:</label>
                <select id="double-sided" class="form-control">
                    <option value="1">1 mặt</option>
                    <option value="2">2 mặt</option>
                </select>
            </div>
            <div class="grid-item">
                <label for="laminating">Cán/ép:</label>
                <select id="laminating" class="form-control">
                    <option value="no">Không</option>
                    <option value="bong">Cán màng bóng</option>
                    <option value="mo" selected>Cán màng mờ</option>
                    <option value="plastic">Ép plastic</option>
                </select>
            </div>
            <div class="grid-item">
                <label for="bo-goc">Yêu cầu bo góc:</label>
                <select id="bo-goc" class="form-control">
                    <option value="no">Không</option>
                    <option value="yes" selected>Có</option>
                </select>
            </div>
            <div class="grid-item button-span">
                <button onclick="calculatePrice()" class="btn btn-primary">Tính Giá</button>
            </div>
        </div>
        <div id="price-result" class="result"></div>
    </div>
    <div class="container">
        <h1>Bảng Giá Dịch Vụ In Ấn & Thiết Kế</h1>

        <div id="design-services">
            <h2>Thiết Kế</h2>
        </div>

        <hr>

        <div id="printing-services">
            <h2>In Ấn</h2>
        </div>

        <p class="note">**Lưu ý:** Bảng giá có thể thay đổi tùy thuộc vào số lượng, chất liệu và yêu cầu riêng.</p>

    </div>

    <script>
        function calculatePrice() {
            // Định nghĩa mức giá
            const giayIn = 1200;
            const mucIn = 1200;
            const mangBong = 1500;
            const mangMo = 1000;
            const catMay = 200;
            const catKhuonLon = 300;
			const catKhuonNho = 100;
            const catThuCong = 500;
            const boGoc = 200;

            // Lấy giá trị từ các trường input và select
            const quantity = document.getElementById('quantity').value;
            const length = document.getElementById('length').value;
            const width = document.getElementById('width').value;
            const doubleSided = document.getElementById('double-sided').value;
            const laminating = document.getElementById('laminating').value;
            const chonBoGoc = document.getElementById('bo-goc').value;

            // Chuyển đổi các giá trị số từ chuỗi sang số nguyên
            const soLuong = parseInt(quantity);
            const chieuDai = parseInt(length);
            const chieuRong = parseInt(width);
            const soMat = parseInt(doubleSided);
            const yeuCauCanMang = laminating; // giá trị 'no', 'bong', hoặc 'mo'

            // Kích thước giấy A4 (đã làm tròn)
            const a4Length = 280; // mm
            const a4Width = 200; // mm

            // Kiểm tra xem các giá trị số có hợp lệ hay không
            if (isNaN(soLuong) || isNaN(chieuDai) || isNaN(chieuRong) || soLuong <= 0 || chieuDai <= 0 || chieuRong <= 0) {
                document.getElementById('price-result').textContent = 'Vui lòng nhập các giá trị số hợp lệ.';
                return;
            }

            // --- BẮT ĐẦU CÔNG THỨC TÍNH TOÁN CỦA BẠN ---

            // Cách 1: Sắp xếp theo chiều gốc của hình
            const hinhTheoChieuDai1 = Math.floor(a4Length / chieuDai);
            const hinhTheoChieuRong1 = Math.floor(a4Width / chieuRong);
            const tongHinh1 = hinhTheoChieuDai1 * hinhTheoChieuRong1;

            // Cách 2: Sắp xếp xoay ngang hình
            const hinhTheoChieuDai2 = Math.floor(a4Length / chieuRong);
            const hinhTheoChieuRong2 = Math.floor(a4Width / chieuDai);
            const tongHinh2 = hinhTheoChieuDai2 * hinhTheoChieuRong2;

            // Lấy số lượng hình tối đa lớn hơn trong 2 cách
            const soHinhToiDa = Math.max(tongHinh1, tongHinh2);
            const soToA4ToiThieu = Math.ceil(soLuong / soHinhToiDa);

            let tongGia = 0;
            // Chi phí giấy
            tongGia += soToA4ToiThieu * giayIn;

            // Chi phí in
            tongGia += soToA4ToiThieu * soMat * mucIn;

            // Chi phí cán màng
            if (yeuCauCanMang === 'bong') {
                tongGia += soToA4ToiThieu * mangBong;
            } else if (yeuCauCanMang === 'mo') {
                tongGia += soToA4ToiThieu * mangMo;
            }

            // Chi phí cắt
            if ((chieuDai === 54 && chieuRong === 90) || (chieuDai === 90 && chieuRong === 54)) 
			{
                tongGia += soLuong * catMay;
            } 
			else if ((chieuDai === 54 && chieuRong === 85) || (chieuDai === 85 && chieuRong === 54)) 
			{
                tongGia += soLuong * catKhuonLon;
            }
			else if ((chieuDai === 30 && chieuRong === 40) 
				|| (chieuDai === 40 && chieuRong === 30)
				||(chieuDai === 35 && chieuRong === 45) 
				|| (chieuDai === 45 && chieuRong === 35)) 
			{
                tongGia += soLuong * catKhuonLon;
            }  
			else 
			{
                tongGia += soLuong * catThuCong;
            }

            // Chi phí bo góc
			if(chonBoGoc === "yes")
			{
				tongGia += soLuong * boGoc;
			}

            tongGia /= 0.8;
            // Áp dụng giảm giá theo số lượng
            if (soToA4ToiThieu >= 30) {
                tongGia *= 0.8; // Giảm 20%
            } else if (soToA4ToiThieu >= 20) {
                tongGia *= 0.85; // Giảm 1%
            } else if (soToA4ToiThieu >= 10) {
                tongGia *= 0.9; // Giảm 10%
            } else if (soToA4ToiThieu >= 5) {
                tongGia *= 0.95; // Giảm 5%
            }

            // --- KẾT THÚC CÔNG THỨC TÍNH GIÁ CỦA BẠN ---

            // Hiển thị kết quả
            const boiSo = 500;
            const tongGiaLamTron = Math.ceil(tongGia / boiSo) * boiSo;
            document.getElementById('price-result').textContent = `Tổng giá: ${tongGiaLamTron.toLocaleString('vi-VN')} VNĐ`;
        }
        // Hàm để tạo bảng từ dữ liệu JSON
        function createTable(data, containerId, headerLabels) {
            const container = document.getElementById(containerId);
            let tableHTML = '<table><thead><tr>';

            // Tạo tiêu đề bảng
            headerLabels.forEach(label => {
                tableHTML += `<th>${label}</th>`;
            });
            tableHTML += '</tr></thead><tbody>';

            // Tạo các hàng dữ liệu
            data.forEach(item => {
                tableHTML += '<tr>';
                for (const key in item) {
                    tableHTML += `<td>${item[key]}</td>`;
                }
                tableHTML += '</tr>';
            });

            tableHTML += '</tbody></table>';
            container.innerHTML += tableHTML;
        }

        function createTableInAn(data, containerId, headerLabels) {
            const container = document.getElementById(containerId);
            let tableHTML = '<table><thead><tr>';

            // Tạo tiêu đề bảng từ mảng headerLabels
            headerLabels.forEach(label => {
                tableHTML += `<th>${label}</th>`;
            });
            tableHTML += '</tr></thead><tbody>';

            // Tạo các hàng dữ liệu, chỉ hiển thị các cột được chỉ định
            data.forEach(item => {
                tableHTML += '<tr>';
                // Chỉ lấy và hiển thị các trường 'san_pham', 'chat_lieu', và 'gia'
                tableHTML += `<td>${item.san_pham}</td>`;
                tableHTML += `<td>${item.chat_lieu}</td>`;
                tableHTML += `<td>${item.gia}</td>`;
                tableHTML += '</tr>';
            });

            tableHTML += '</tbody></table>';
            container.innerHTML += tableHTML;
        }

        // Đọc file JSON và tạo bảng
        fetch('data.json')
            .then(response => response.json())
            .then(data => {
                // Tạo bảng cho dịch vụ Thiết kế
                createTable(data.thiet_ke, 'design-services', ['Dịch Vụ', 'Mô Tả', 'Giá (VNĐ)']);

                // Tạo bảng cho dịch vụ In ấn
                createTableInAn(data.in_an, 'printing-services', ['Sản Phẩm', 'Chất liệu', 'Giá (VND)']);
            })
            .catch(error => console.error('Lỗi khi đọc file JSON:', error));
    </script>
</body>

</html>
